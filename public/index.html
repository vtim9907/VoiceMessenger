<!doctype html>
<html lang="en" style='margin:0'>

<head>
  <title>index</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" 
    crossorigin="anonymous">
  <!-- <link rel="stylesheet" href="https://bootswatch.com/4/darkly/bootstrap.min.css"> -->
  <link href="css/main.css" rel="stylesheet">
  <link href="chat/chat.css" rel="stylesheet">
  <link href="card/loading.css" rel="stylesheet">
  <link href="forum/forum.css" rel="stylesheet">
  <link href="qa/qa.css" rel="stylesheet">
  <link rel="manifest" href="./manifest.json">
  <script type="text/javascript" src="js/Vue.js"></script>
  <script type="text/javascript" src="js/lame.all.js"></script>
  <script type="text/javascript" src="js/RecordRTC.js"></script>
  <script type="text/javascript" src="./service_worker.js"></script>
  <script type="text/javascript" src="js/peer.js"></script>
</head>

<body onresize='responsive()' class='bd-drak'>
  <div class='wrapper'>
    <nav class="navbar navbar-expand-md flex-column navbar-dark" :style='styleObject' id='sidebar'>
      <div class="container-fluid">
        <div class="container" style="padding-top:1vh;">
          <a class="navbar-brand" href="#">
            <img src="img/logo-voiceMessage.png" alt="" class="d-inline-block align-top">
          </a>
        </div>
        <button class="navbar-toggler justify-content-end" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
          aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>
      <div style="padding-top:3vh;">
        <img :src='photo' :style='styleimg'>
      </div>
      <div class="collapse navbar-collapse " id="navbarNav">
        <ul class="navbar-nav flex-column ">
          <li class="nav-item" v-for='i in List'>
            <a class="nav-link" href="#" @click="show(i)"> {{i}} </a>
          </li>
          <a class="nav-link" href="/logout">登出</a>
        </ul>
      </div>
    </nav>
  </div>

  <div id='mainPage' :style='styleObject'>

    <div v-if="Pageshown=='編輯資料'">
      <edit></edit>
    </div>

    <div v-if="Pageshown=='好友'">
      <friends></friends>
    </div>

    <div v-if="Pageshown=='聊天'">
      <chat></chat>
    </div>

    <div v-if="Pageshown=='論壇'">
      <forum></forum>
    </div>

    <div v-if="Pageshown=='抽卡'">
      <card></card>
    </div>

    <div v-if="Pageshown=='說明'">
      <qa></qa>
    </div>

    <div v-if="Pageshown=='錄音'">
      <record></record>
    </div>

    <!-- Modal for new post -->
    <div class="modal fade" id="new_post" role="dialog">
      <div class="modal-dialog modal-lg" role="document">
      
          <!-- Modal content-->
          <div class="modal-content post-publish-area">
          <div class="modal-header">
              <h4 class="modal-title">發表文章</h4>
              <button type="button" class="close post-cancel" data-dismiss="modal">&times;</button>
          </div>
          <div class="modal-body">
              <textarea class="form-control post-textarea" rows="5" placeholder="在想些什麼？" maxlength="200" id="new_post_content"></textarea>
          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
              <button type="button" class="btn btn-primary" id="send_post">PO文</button>
          </div>
          </div>
          
      </div>
    </div>
  </div>

  <div id='weatherGrid'>
    <div id="sky"></div>
  </div>

  <script type="text/x-template" id="record">
    <div class="row justify-content-center">
      <div class="">
        <div class="col-12 text-center">click picture to start recording</div>
        <img class="w-100" src="/img/microphone.png" @click="clicked()">
      </div>
      <!-- Modal -->
      <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">{{message}}</h5>
            </div>
            <div class="modal-body">
              <canvas class="w-100 h-75 border rounded border-primary" id="canvas"></canvas>
              <audio class="col-8 d-none" :id="i" controls v-for="i in audioList"></audio> 
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary" data-dismiss="modal" v-if="showButton">Close</button>
              <button type="button" class="btn btn-primary" @click="encode()" v-if="showButton">record</button>
              <button type="button" class="btn btn-primary" @click="play()" v-if="showButton">play</button>
            </div>
          </div>
        </div>
      </div>
    </div >   
    </script>

  <script type="text/x-template" id="edit">
        <div class="container" style="padding-top:5vh;">
          <div class="text-center editForm"  style="border-radius: 15px; padding:15px;">
            <h1>編輯個人檔案</h1><hr /><br>
            <form id="register" action="/editProfile" method="post" enctype="multipart/form-data">
              <div class="form-group row">
                <label class="col-form-label  col-sm-2">暱稱</label>
                <div class="col-sm-4">
                  <input type="text" name="nickname" class="form-control" v-model="name">
                </div>
              </div>
              <div class="form-group row">
                <label class="col-form-label  col-sm-2">性別</label>
                <div class="col-sm-2">
                  <div v-if="gender==0">
                  <select name="gender" form="register" class="form-control">
                    <option value="0" selected="selected">保密</option>
                    <option value="1">男</option>
                    <option value="2">女</option>
                  </select>
                  </div>
                  <div v-if="gender==1">
                  <select name="gender" form="register" class="form-control">
                    <option value="0">保密</option>
                    <option value="1" selected="selected">男</option>
                    <option value="2">女</option>
                  </select>
                  </div>
                  <div v-if="gender==2">
                  <select name="gender" form="register" class="form-control">
                    <option value="0">保密</option>
                    <option value="1">男</option>
                    <option value="2" selected="selected">女</option>
                  </select>
                  </div>
                </div>
              </div>
              <div class="form-group row">
                <label class="col-form-label  col-sm-2">年齡</label>
                <div class="col-sm-1">
                  <input type="number" name="age" class="form-control" min="1" step="1" v-model="age">
                </div>
              </div>
              <!-- <div class="form-group row">
                <label class="col-form-label  col-sm-2">更換大頭照</label>
                <div class="col-sm-4 text-left">
                  <label class="custom-file">
                    <input type="file"  class="custom-file-input" accept="image/*" name="myphoto" onchange="$(this).next().after().text($(this).val().split('\\').slice(-1)[0])">
                    <span class="custom-file-control"></span>
                  </label>
                </div>
              </div> -->
              <br><br>
              <button class="btn btn-lg btn-primary btn-block" type="submit">Submit</button> 
            </form> 
          </div>
        </div>
    </script>

  <script type='text/x-template' id="friends">
    <div class='d-flex justify-content-center text-center' style='padding:16px'>
      <div class="text-center" v-if="not_found">
        <div class="container">
          <h1>還沒有朋友...</h1>
        </div>
      </div>
      <div v-else>
        <div class="container row">
          <div class="col-sm-4" style="width: 450px; hight: 450px;" v-for='i in lists'>
            <img class="card-img-top" :src="i.photoPath" alt="Card image cap">
            <div class="card-block justify-content-center text-center">
              <h3 class="card-title"> {{i.nickname}}</h3>
            </div>
          </div>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="card">
    <div id="card_container">
      <keep-alive>
        <component :is="currentView" :name="name" :photo="photo" :voice="voice"></component>
      </keep-alive>
    </div>
  </script>

  <script type="text/x-template" id="card_loading">
    <div class="sk-folding-cube">
      <div class="sk-cube1 sk-cube"></div>
      <div class="sk-cube2 sk-cube"></div>
      <div class="sk-cube4 sk-cube"></div>
      <div class="sk-cube3 sk-cube"></div>
    </div>
  </script>

  <script type="text/x-template" id="card_content">
    <div>
      <div class="card text-center" style="width:20rem;">
        <img class="card-img-top" :src="photo" >
        <div class="card-body">
          <h1 class="card-title">{{name}}</h1>
        </div>
        <div class="card-body">
          <audio id="voice" @ended="handleEnded()">
            <source :src="voice" type="audio/mpeg">
          </audio>
          <button type="button" class="btn btn-info btn-lg" @click="playOrStop()">
            <i class="fa fa-play" aria-hidden="true"></i> {{playerMsg}}
          </button>
        </div>
        <br><br>
        <a href="/friendRequest" class="btn btn-primary">送出邀請</a>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="forum">
    <div id="forum_container">
      <keep-alive>
        <component :is="currentView"></component>
      </keep-alive>
    </div>
  </script>

  <script type="text/x-template" id="forum_content">
    <div class="container">
      <div class="col-12" style="border: black 1px;">
        <button type="button" class="btn btn-primary btn-md container forum-goto-post" onclick="$('#new_post').modal('toggle');">發表文章</button>
        <div class="forum-list">
            <!-- <span class="list-group-item post-entry" onclick="$('#new_post').modal();">First item</span> -->
            <div class="row post-entry list-group-item">
                <span class="col-1">
                <img src="https://goo.gl/eKdiuU" class="post-entry-image col-1 align-middle">
                </span>
                <span class="col-11">
                    <a>HELLO WORLD!</a>
                </span>
            </div>
        <div>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="forum_loading">
    <div class="sk-folding-cube">
      <div class="sk-cube1 sk-cube"></div>
      <div class="sk-cube2 sk-cube"></div>
      <div class="sk-cube4 sk-cube"></div>
      <div class="sk-cube3 sk-cube"></div>
    </div>
  </script>

    <script type="text/x-template" id="chat">
      <div class="container" style='padding:16px'>
        <div class="text-center" v-if="not_found">
          <div class="container">
            <h1>還沒有朋友...</h1>
          </div>
        </div>
        <div v-else>
          <div class="row">
            <div class="col-sm-2">
             <ul class="list-group" style="">
                <li class="list-group-item userName" v-for="i in userList" @click="selectReceiver(i)">{{i}}</li>
             </ul>
            </div>
            <div class="col-sm-6 chatBox">
              <ul id="chatList" class="w-100 border border-dark h-75 list-group customScrollBar scrollbar" style="overflow:scroll;">
                <div v-for="i in content">
                  <div v-if="i.name1 == myName" class="customScrollBar">
                    <li class="list-group-item beautify  userText" >{{i.message}}</li>
                  </div>
                  <div v-else>
                    <li class="list-group-item otherChat beautify  otherText" >{{i.name1}} : {{i.message}}</li>
                  </div>
                </div>
              </ul>
              <br>
              <textarea id="chatTextarea" name='test' class="w-100" rows="4" @keydown.enter.prevent="send" placeholder="請輸入訊息..."></textarea>
            </div>
            <div>
              <audio id="videoTest" autoplay></audio>
              <button @click="voice">voice chat</button>
            </div>
          </div>
        </div>
      </div>
    </script>
    <script type="text/x-template" id="qa">
      <div class="container" style="padding:5vh 0 5vh 0;">
        <div class="text-center frame" >
          <h1>VoiceMessenger是什麼?</h1>
          <p>交友軟體有千百款，但通常交友的依據都只是冰冷的文字介紹。</p>
          <p>VoiceMessenger以錄音的方式取代文字介紹，你可以不必擔心與他人尷尬對話，也可以透過聲音介紹以及認識他人!</p>
        </div>
        <div class="text-center frame">
          <h1>為什麼我不能抽卡?</h1>
          <p>請先確認自己已經完成錄音。</p>
          <p>趕快完成自己的錄音自介才能讓別人認識你!</p>
        </div>
        <div class="text-center frame">
          <h1>為什麼我送出了邀請還沒有成為好友?</h1>
          <p>只有當你主動送出邀請，而對方也有送出邀請的情況下，才會成為好友。</p>
          <p>趕快掌握自己的緣分，勇敢的送出邀請!!</p>
        </div>
        <div class="text-center frame">
          <h1>如何在VoiceMessenger上註冊新帳號?</h1>
          <p>進入VoiceMessenger首頁點選註冊，</p>
          <p>輸入常用信箱以及密碼後，即可完成註冊。</p>
        </div>
      </div>
    </script>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script type="text/javascript" src="https://code.jquery.com/jquery-1.7.1.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
    crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
  <script src=" https://cdn.jsdelivr.net/npm/vue"></script>
  <script type="text/javascript" src="js/record.js"></script>
  <script type="text/javascript" src="card/card.js"></script>
  <script type="text/javascript" src="forum/forum.js"></script>
  <script type="text/javascript" src="forum/new_post.js"></script>
  <script type="text/javascript" src="grid/grid.js"></script>
  <script type="text/javascript" src="chat/chat.js"></script>
  <script type="text/javascript" src="friends/friends.js"></script>
  <script type="text/javascript" src="edit/edit.js"></script>
  <script type='text/javascript' src='js/sidebar.js'></script>
  <script type="text/javascript" src="js/register.js"></script>
  <script type="text/javascript" src="qa/qa.js"></script>

</body>

</html>
